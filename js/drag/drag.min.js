// drag.js 0.0.1-alpha
// Build Date: 2012-11-18

// (c) 2012 Kristofer Joseph.
// This may be freely distributed under the MIT license.
(function(e){"use strict";e.event.props.push("dataTransfer");var t=e.event.fixHooks.mousedown.filter;e.event.fixHooks.mousedown.filter=function(n,r){return n=t(n,r),n.offsetX||(n.offsetX=n.pageX-e(n.target).offset().left,n.offsetY=n.pageY-e(n.target).offset().top),n},e.Event.prototype.stop=function(){this.stopPropagation(),this.preventDefault()},e.fn.drag=function(t){var n=this,r=e.extend({target:"body",setData:"Text",transferEffect:"copyMove",start:function(e,t){return this},drag:function(e,t){return this},enter:function(e,t){return this},over:function(e,t){return this},leave:function(e,t){return this},drop:function(e,t){return t.offset({top:e.originalEvent.pageY-t.offsetY,left:e.originalEvent.pageX-t.offsetX}),this},end:function(e,t){return this}},t);return n.start=r.start,n.drag=r.drag,n.enter=r.enter,n.over=r.over,n.leave=r.leave,n.drop=r.drop,n.end=r.end,e(r.target).on("dragenter",function(e){return e.stop(),n.enter.call(n,e,n),!1}).on("dragover",function(e){return e.preventDefault(),e.dataTransfer.dropEffect=r.transferEffect,n.over.call(n,e,n),!1}).on("dragleave",function(e){e.stopPropagation(),n.leave.call(n,e,n)}).on("drop",function(e){return e.stop(),n.drop.call(n,e,n),!1}),n.mousedown(function(e){e.stopPropagation(),this.draggable=!0,n.offsetX=e.offsetX||0,n.offsetY=e.offsetY||0}).on("dragstart",function(e){e.stopPropagation(),e.dataTransfer.effectAllowed=r.transferEffect,e.dataTransfer.setData(r.setData,n.id),n.start.call(n,e,n)}).on("drag",function(e){n.drag.call(n,e,n)}).on("dragend",function(e){e.stopPropagation(),this.draggable=!1,n.end.call(n,e,n)}),n}})(jQuery);